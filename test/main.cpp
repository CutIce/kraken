#include <iostream>
using namespace std;

int main() {
/*    double data30[5]={13.23  ,  13.25  ,  13.28  ,  13.23  ,  13.22};
    double data35[5]={9.40  ,  9.22  ,  9.23  ,  9.00  ,  9.03};
    double data40[5]={6.45  ,  6.52  ,  6.53  ,  6.52  ,  6.54};
    double data45[5]={4.83  ,  4.97  ,  4.78  ,  4.74  ,  4.78};
    double data50[5]={3.62  ,  3.55  ,  3.60  ,  3.82  ,  3.56};
    double data55[5]={2.79  ,  2.64  ,  2.83  ,  2.84  ,  2.81};*/

    double l=0.300;
    double p=7800.0  ,   p0=950.0  ,  D=0.02  ,  d=0.0;
    double dl[8]={ 0.001493   ,   0.001494   ,   0.001483   ,   0.001460    ,  0.001521   ,  0.001470   ,  0.001491   ,   0.001501};
    double re[7]={0.0};
    for (int i=0;i<8;++i)
        d+=dl[i];
    d/=8.0;
    d=0.001490;

    double truedata[7]={0.6210  ,  0.4510  ,  0.3120  ,  0.2310  ,   0.160964    ,        0.121224   ,         0.092905};

    /*double data[7][5]={     {19.00  ,  19.0  ,  19.0  ,  19.0  ,  19.0 }  ,
                            {13.23  ,  13.25  ,  13.28  ,  13.23  ,  13.22}  ,
                            {9.40  ,  9.22  ,  9.23  ,  9.00  ,  9.03}  ,
                            {6.45  ,  6.52  ,  6.53  ,  6.52  ,  6.54}  ,
                            {4.83  ,  4.97  ,  4.78  ,  4.74  ,  4.78}  ,
                            {3.62  ,  3.55  ,  3.60  ,  3.82  ,  3.56}  ,
                            {2.79  ,  2.64  ,  2.83  ,  2.84  ,  2.81}};*/
    /*double data[7][5]={     {20.13  ,  19.17  ,  19.45  ,  19.18  ,  19.46 }  ,
                            {13.25  ,  12.98  ,  13.29  ,  12.84  ,  13.31}  ,
                            {9.24  ,  9.23  ,  9.31  ,  9.42  ,  9.23}  ,
                            {6.67  ,  6.21  ,  6.54  ,  6.55  ,  6.54}  ,
                            {4.80  ,  4.48  ,  4.78  ,  4.79  ,  4.81}  ,
                            {3.63  ,  3.63  ,  3.60  ,  3.63  ,  3.60}  ,
                            {2.87  ,  2.80  ,  2.82  ,  2.76  ,  2.83}};*/
    /*double data[7][5]={     {23.14  ,  22.78  ,  23.56  ,  22.21  ,  22.60 }  ,
                            {16.23  ,  15.87  ,  16.25  ,  16.24  ,  13.31}  ,
                            {11.30  ,  11.27  ,  11.30  ,  11.29  ,  11.27}  ,
                            {7.98  , 7.96  ,  8.02  ,  8.03  ,  7.96}  ,
                            {5.84  ,  5.43  ,  5.83  ,  5.79  ,  5.86}  ,
                            {4.42  ,  4.38  ,  4.44  ,  4.41  ,  4.40}  ,
                            {3.46  ,  3.49  ,  3.42  ,  3.44  ,  3.44}};*/
    double data[7][5]={     {27.62  ,  27.25  ,  28.09  ,  27.60  ,  28.05 }  ,
                            {19.50  ,  19.52  ,  19.53  ,  19.53  ,  19.59}  ,
                            {13.59  ,  13.57  ,  13.61  ,  13.18  ,  13.33}  ,
                            {9.64  ,  9.68  ,  9.65  ,  9.61  ,  9.64}  ,
                            {6.97  ,  7.08  ,  7.04  ,  6.98  ,  7.01}  ,
                            {5.31  ,  5.26  ,  5.26  ,  5.34  ,  5.29}  ,
                            {4.15  ,  4.17  ,  4.14  ,  4.09  ,  4.19}};
    double x[7]={0.0};  // 时间均值
    double v[7]={0.0};  // 速度
    double n[7]={0.0};  // 粘滞系数
    double n1[7]={0.0}; // 修正后的粘滞系数
    double u[7]={0.0};  // 相对误差

    for (int i=0;i<7;++i) {
        for (int j=0;j<5;++j)
        {   x[i]+=data[i][j];   }
        x[i]/=5.0;
        v[i]=l/x[i];
        n[i]=(p-p0)*9.8*d*d/18/v[i]/(1+2.4*d/D);
        re[i]=v[i]*d*p0/n[i];
        //n1[i]=n[i]-3*v[i]*d*p0/16;
        n1[i]=n[i]/(1+3*re[i]/16);
        u[i]=(n[i]-truedata[i])/truedata[i];
    }
    cout<<"d:"<<'\t'<<d<<endl;
    cout<<"mean time:"<<endl;
    for (int i=0;i<7;++i)  cout<<x[i]<<'\t';
    cout<<endl;
    cout<<"v:"<<endl;
    for (int i=0;i<7;++i)  cout<<v[i]<<'\t';
    cout<<endl;
    cout<<"re:"<<endl;
    for (int i=0;i<7;++i)  cout<<re[i]<<'\t';
    cout<<endl;
    cout<<"no modify n"<<endl;
    for (int i=0;i<7;++i)  cout<<n[i]<<'\t';
    cout<<endl;
    cout<<"modified n:"<<endl;
    for (int i=0;i<7;++i)  cout<<n1[i]<<'\t';
    cout<<endl;
    cout<<"true data:"<<endl;
    for (int i=0;i<7;++i)  cout<<truedata[i]<<'\t';
    cout<<endl;
    cout<<"uncertain u :"<<endl;
    for (int i=0;i<7;++i)  cout<<u[i]<<'\t';
 }

/*d:      0.001481
mean time:
19.478  13.134  9.286   6.502   4.732   3.618   2.816
v:
0.010268        0.0152277       0.0215378       0.0307598       0.0422654       0.0552792       0.0710227
re:
0.0213569       0.0469713       0.0939656       0.19166 0.361857        0.618998        1.02179
no modify n
0.676436        0.45612 0.322486        0.225803        0.164334        0.125647        0.0977946
modified n:
0.673738        0.452138        0.316903        0.21797 0.153892        0.11258 0.082071
uncertain u :
0.0892686       0.0113528       0.033609        -0.022499       0.0209352       0.036483        0.0526301*/
